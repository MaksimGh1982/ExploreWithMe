
CREATE TABLE IF NOT EXISTS USERS
( id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  email VARCHAR(255) NOT NULL,
  Name  VARCHAR(255) NOT NULL,
  created TIMESTAMP WITHOUT TIME ZONE DEFAULT NOW(),
  PRIMARY KEY (Id));

CREATE TABLE IF NOT EXISTS Categories
( id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  Name VARCHAR(255) NOT NULL UNIQUE,
  PRIMARY KEY (Id));


CREATE TABLE IF NOT EXISTS Compilations
( id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  title VARCHAR(255) NOT NULL,
  pinned boolean NOT NULL,
  PRIMARY KEY (Id));

CREATE TABLE IF NOT EXISTS Events
( id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  annotation VARCHAR(2000) NOT NULL,
  categoryId	INTEGER NOT NULL,
  description VARCHAR(7000) NOT NULL,
  eventDate  DATE NOT NULL,
  location_lat	 NUMERIC NOT NULL,
  location_lon	 NUMERIC NOT NULL,
  paid	BOOLEAN DEFAULT false,
  participantLimit	INTEGER DEFAULT 0,
  requestModeration	BOOLEAN DEFAULT true,
  title VARCHAR(120) NOT NULL,
  views INTEGER DEFAULT 0,
  confirmed_requests INTEGER DEFAULT 0,
  PRIMARY KEY (Id),
  FOREIGN KEY (categoryId)  REFERENCES Categories(Id) ON DELETE RESTRICT);

CREATE TABLE IF NOT EXISTS EventsCompilations
( id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  CompilationsId INTEGER NOT NULL,
  EventId INTEGER NOT NULL,
  PRIMARY KEY (Id),
  FOREIGN KEY (CompilationsId)  REFERENCES Compilations (Id),
  FOREIGN KEY (EventId)  REFERENCES Events (Id));


CREATE TABLE IF NOT EXISTS Requests
(  id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
  RequesterId INTEGER NOT NULL,
  EventId INTEGER NOT NULL,
  created DATE NOT NULL,
  status  VARCHAR(255) NOT NULL,
  PRIMARY KEY (Id),
  FOREIGN KEY (RequesterId)  REFERENCES USERS (Id),
  FOREIGN KEY (EventId)  REFERENCES Events (Id));





